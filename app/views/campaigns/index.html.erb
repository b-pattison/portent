<h1>Campaigns</h1>

<% if @campaign&.errors&.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@campaign.errors.count, "error") %> prohibited this campaign from being saved:</h2>
    <ul>
      <% @campaign.errors.each do |error| %>
        <li><%= error.full_message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<% if current_user.can_create_campaign? %>
  <%= form_with model: @campaign, url: campaigns_path do |f| %>
    <div>
      <%= f.label :name, "Campaign name" %>
      <%= f.text_field :name, placeholder: "Enter campaign name", required: true %>
    </div>

    <%= f.submit "Create Campaign", class: "btn btn-primary" %>
  <% end %>
<% else %>
  <div class="alert alert-danger">
    <%= flash[:alert] || "Upgrade to create more campaigns." %>
  </div>
<% end %>

<hr>

<% if @campaigns.empty? %>
  <div class="card text-center">
    <p style="opacity: 0.7; font-size: clamp(16px, 4vw, 18px);">No campaigns yet. Create your first campaign to begin!</p>
  </div>
<% else %>
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(min(100%, 300px), 1fr)); gap: clamp(16px, 4vw, 24px);">
    <% @campaigns.each do |campaign| %>
      <div class="card">
        <h3 style="margin-bottom: 12px; font-size: clamp(18px, 4vw, 22px);">
          <%= link_to campaign.name, campaign_path(campaign), style: "color: var(--gold); text-decoration: none;" %>
        </h3>
        <p style="opacity: 0.7; font-size: clamp(12px, 3vw, 14px); margin-bottom: 16px;">
          Created <%= campaign.created_at.strftime("%B %d, %Y") %>
        </p>
        <%= link_to "View Campaign â†’", campaign_path(campaign), class: "btn btn-secondary", style: "width: 100%;" %>
      </div>
    <% end %>
  </div>
<% end %>
